#ifndef FIR_FILTER_H
#define FIR_FILTER_H

#include <Arduino.h>

extern "C" {
  #include "dsps_fir.h"
}

#define FIR_NUM_OF_COE 53
class FIR_Filter {
public:
    FIR_Filter();
    bool init();
    void process(float* input, float* output, int len);

private:
    fir_f32_t filter;
    float state[FIR_NUM_OF_COE];           // Internal state (delay line)
    float coeffs[FIR_NUM_OF_COE] = { 
    -0.000574906859963121,
    0.000000000000000001,
    0.000726878656656865,
    0.001444470981603404,
    0.001823411763234968,
    0.001436279187495883,
    -0.000000000000000002,
    -0.002310616106483979,
    -0.004680774400172320,
    -0.005801495059961710,
    -0.004401148062126011,
    0.000000000000000003,
    0.006466871282307920,
    0.012557954337108400,
    0.015001347272149222,
    0.011042272216301127,
    -0.000000000000000005,
    -0.015648716510277744,
    -0.030281609195214557,
    -0.036496051465025964,
    -0.027538264420590371,
    0.000000000000000007,
    0.044249959513353213,
    0.097761326729313300,
    0.149140033916397047,
    0.186218067602480941,
    0.199729417242827056,
    0.186218067602480941,
    0.149140033916397047,
    0.097761326729313300,
    0.044249959513353219,
    0.000000000000000007,
    -0.027538264420590371,
    -0.036496051465025971,
    -0.030281609195214564,
    -0.015648716510277747,
    -0.000000000000000005,
    0.011042272216301129,
    0.015001347272149230,
    0.012557954337108400,
    0.006466871282307920,
    0.000000000000000003,
    -0.004401148062126011,
    -0.005801495059961714,
    -0.004680774400172329,
    -0.002310616106483979,
    -0.000000000000000002,
    0.001436279187495883,
    0.001823411763234967,
    0.001444470981603405,
    0.000726878656656865,
    0.000000000000000001,
    -0.000574906859963121,
  }; 
};

#endif